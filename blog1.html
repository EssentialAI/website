<!DOCTYPE html>
<html>

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QLEH0W42YV"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-QLEH0W42YV');
  </script>
  <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous"> -->

  <link id="mystylesheet" rel="stylesheet" type="text/css" href="light.css">
  <!-- <link rel="stylesheet" href="light.css"> -->
  <link rel="icon" href="brain1.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Alegreya+Sans+SC:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Nunito&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  <!-- <script>
    function myFunction() {
      var element = document.body;
      element.classList.toggle("dark-mode");
    }
  </script> -->
  <title>EssentialAI</title>
</head>

<body>
  <div class="topnav">
    <a class="top" href="index.html">Blog</a>
    <a class="top" href="about.html">About</a>
    <!-- <a class="top" href="publications.html">Publications</a> -->
    <!-- <a id="small" href="research.html">Misc. research articles</a> -->
    <button id="dark-mode-toggle" class="dark-mode-toggle">
  <svg width="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 496"><path fill="currentColor" d="M8,256C8,393,119,504,256,504S504,393,504,256,393,8,256,8,8,119,8,256ZM256,440V72a184,184,0,0,1,0,368Z" transform="translate(-8 -8)"/></svg>
</button>
  </div>
  <!-- Start your blog here -->
  <!-- ################################################################################ -->
  <h1 class="bloghead">Linear Regression from Scratch (I-D)</h1><br>
  <!-- <p class = "content"><i style="color:red">(Website under development. Articles coming in a couple of days)</i></p> -->
  <!-- <p class="content">The HTML <span>button</span> tag defines a clickable button.</p>
  <p class="content">The CSS <span class="markdown">background-color</span> property defines the background color of an
    element.</p> -->
  <p class="content"> <span class='highlight'>Has it ever occurred to you that something so
      simple of a
      concept can be so
      compelling that you
      wish you knew it before?</span> Well, Linear Regression is one of those concepts for me. Linear Regression helped
    me
    understand the true impact of statistics, and all the years of learning calculus finally fell into place. Linear
    Regression sounds complex, while it's not. Many have already learned it in their high
    school as an
    exercise, "Finding the line of best fit," finding the line that goes through the center of all the dots spread
    across x and y axes as shown below.</p>

  <div class="content"><iframe width="700" height="500" frameborder="0" scrolling="no"
      src="https://www.plotly.com/~Naresh6017/1.embed?showlink=false"></iframe></div>
  <p class="content"><span class='highlight'>Okay, so how do we develop this line of best fit
      once a set of data points are given?</span> Let's play a
    game to come up with this line, shall we? Let's suppose there existed no algorithm for Linear Regression beforehand,
    and we have to come up with a model that everyone will use. How will we, mediocre mathematicians with an
    intermediate knowledge in calculus, might conjure something like that? Before we proceed, let me clarify some points
    here. We
    have data points <span class='latex'>\(x_{i}\)</span> and <span class='latex'>\(y_{i}\)</span>, and we have to come
    up with a line <span class='latex'>\(\hat{y_{i}}=ax_{i}+b\)</span> that best
    fits these points.<span class='highlight'> Every solution
      has one objective at its core,
      minimizing the error. Let's start with that.</span>

    In this case, the error will be the distance between a data point <span class='latex'>\(x_{i}\)</span> and the
    predicted line <span class='latex'>\(\hat{y}\)</span> as shown. We must
    formulate an error function generic for all data points and then try and minimize this using calculus.</p>
  <div class="content"><iframe width="700" height="500" frameborder="0" scrolling="no"
      src="https://www.plotly.com/~Naresh6017/5.embed?showlink=false"></iframe></div>
  <!-- <div class="content"> <img src="blog1img1.png" alt=""></div> -->
  <div class="content">Formulating an error function and using calculus (differentiate and equate to zero) is our
    current plan. As we discussed, that error is in terms of the distance from a data point to the line. <span
      class='highlight'>Can we sum over
      all the distances to get an error function? Unfortunately, No!</span> The reason is two-fold; if we consider
    opposite
    signs for points lying on either side of <span class='latex'>\(\hat{y}\)</span>, we might end up negating the error
    of two points equally spaced on
    either side. This approach considers the error to be zero while it's not. (Let's take modulus, right? No sign
    issue!) Actually, No! Remember that we have to differentiate error function, and modulus function is not
    differentiable at
    zero. What we can do is square the distance for all the points. This approach solves both the issues (distances
    won't cancel out, and parabola is differentiable)</div>

  <div class='content'>
    <p class="latex">\(\begin{align}E = \sum_{i=1}^{N}(y_{i}-\hat{y_{i}})^2 = \sum_{i=1}^{N}(y_{i}-(ax_{i}+b))^2
      \end{align}\)</p>


  </div>
  <!-- <div class='content' style="border-radius: 200px;"> -->
  <p class='scenter'><img style="border-radius: 5px;" src=" loss.gif" alt=""></p>
  <p class='scenter' style="font-size: 16px; padding-top: 0%;padding-bottom: 0%;">Distances are squared and added to
    get the error (loss)
    function</p>
  <!-- </div> -->
  <p class='scenter'>Here the variables are <span class='latex'>\(a\)</span> and <span class='latex'>\(b\)</span> (not x
    and y).
    We must minimize E
    w.r.t <span class='latex'>\(a\)</span> and <span class='latex'>\(b\)</span></p>
  <p class='latex'>\(\begin{align}\frac{\partial E}{\partial a} \rightarrow 0 =
    \sum_{i=1}^{N}(y_{i}-(ax_{i}+b))(-x_{i}) = 0 \end{align}\)</p>
    <p class='latex'>\(\begin{align}\rightarrow a\sum_{i=1}^{N}x_{i}^2 +b \sum_{i=1}^{N}x_{i} = \sum_{i=1}^{N}y_{i}x_{i} \rightarrow (1)\end{align}\)</p>
    <p class='latex'>\(\begin{align}similarly \enspace \frac{\partial
      E}{\partial b}=0 \rightarrow a\sum_{i=1}^{N}x_{i} +b \sum_{i=1}^{N}1 =
      \sum_{i=1}^{N}y_{i} \rightarrow (2) \end{align}\)</p>
  <p class='scenter'>Solving <span class='latex'>\((1)\)</span> and <span class='latex'>\((2)\)</span> for <span
      class='latex'>\(a\)</span> and <span class='latex'>\(b\)</span> gives</p>
  <div class='scenter'>
    <p class='latex'>\(\begin{align} a = \frac{\bar{xy}-\bar{x}\bar{y}}{\bar{x^2}-\bar{x}^2},\enspace b =
      \frac{\bar{y}\bar{x^2}-\bar{x}.\bar{xy}}{\bar{x^2}-\bar{x}^2}\end{align} \)
    </p>
  </div>

  <br>
  <div class='content'>Okay. So we have the values for <span class='latex'>\(a\)</span> and <span
      class='latex'>\(b\)</span> that we got by minimizing the error (also called Sum of
    squared residuals <span class='latex'>\(SS_{Res}\)</span>. Now the next step is validating our result. How do we do
    that? Luckily we have <span class='latex'>\(R^2\)</span> to validate our results. It is defined as shown below</div>

  <div class='scenter'>
    <p class='latex'>\( R^2 = 1-\frac{SS_{Res}}{SS_{total}} \)
    </p>
  </div>

  <div class='content'>
    <p class='scenter'><span class='latex1'>\(SS_{total}\)</span> is defined as <span
        class='latex1'>\(\begin{align}\sum_{i=1}^{N}(y_{i}-\bar{y})^2 \end{align}\)</span></p>
    <p class='scenter'><span class='latex'>\(R^2 = 1\)</span> means that <span class='latex'>\(SS_{Res}=0\)</span>.
      This
      represents the best fit. Error is least.</p>
    <p class='scenter'><span class='latex'>\(R^2 = 0\)</span> means that <span class='latex'>\(SS_{Res}=1\)</span>.
      This
      represents that the model is just predicting <span class='latex'>\(\bar{y}\)</span> always.</p>

    <p class='scenter'><span class='latex'>\(R^2 = -ve\)</span> means that <span
        class='latex'>\(SS_{Res}>SS_{total}\)</span>. This means that the model is pretty worse and needs immediate
      action.</p>
  </div>
  <br>

  <p class='content'>Great! We now have a model for 1-D Linear Regression and measure for validation. Let's get to some
    coding. While we do that, <span class='highlight'>sklearn already has a module for
      Linear
      Regression in place. We can compare the
      performance of these models.</span> Pseudo code is shown below while the complete code is available in this <a
      href="https://github.com/Nareshmlblog/EssentialAI-code" style="text-decoration: none; color: #2ec4b6;">repo</a>
  </p>
  <div class='codediv'>
    <code
      class="ncode"><span class="keyword">def</span><span class="function"> solve_and_fit</span>(self, data)</code><br>
    <code
      class="ncode">&nbsp;&nbsp;&nbsp; denominator<span class="keyword">=</span>self.<span class="module">X</span>.<span class="function">dot</span>(self.<span class="module">X</span>) - self.<span class="module">X</span>.<span class="function">mean</span>()**2</code><br>
    <code
      class='ncode'>&nbsp;&nbsp;&nbsp; m <span class="keyword">=</span> (self.<span class="module">X</span>.<span class="function">dot</span>(self.<span class="module">Y</span>)-self.<span class="module">X</span>.<span class="function">mean</span>()*self.<span class="module">Y</span>.<span class="function">mean</span>())/denominator</code><br>
    <code
      class='ncode'>&nbsp;&nbsp;&nbsp; b <span class="keyword">=</span> (self.<span class="module">X</span>.<span class="function">dot</span>(self.<span class="module">X</span>)*self.<span class="module">Y</span>.<span class="function">mean</span>()-self.<span class="module">X</span>.<span class="function">mean</span>()*self.<span class="module">X</span>.<span class="function">dot</span>(self.<span class="module">Y</span>))/denominator</code><br>
    <code class='ncode'>&nbsp;&nbsp;&nbsp; self.<span class="module">Yhat</span> = m*self.<span class="module">X</span>+b
    </code><br>
    <code
      class="ncode">&nbsp;&nbsp;&nbsp; plt.<span class = 'function'>plot</span>(self.<span class="module">X</span>, self.<span class="module">Yhat</span>, color =<span class = 'variable'>"red"</span>, label = <span class = 'variable'>"Best fit line"</span>)</code><br><br>

    <code class="ncode"><span class="keyword">def</span><span class="function"> r_square</span>(self)</code><br>
    <code
      class="ncode">&nbsp;&nbsp;&nbsp; d1 <span class="keyword">=</span> self.<span class="module">Y</span>-self.<span class="module">Yhat</span></code><br>
    <code
      class="ncode">&nbsp;&nbsp;&nbsp; d2 <span class="keyword">=</span> self.<span class="module">Y</span>-self.<span class="module">Y</span>.<span class = 'function'>mean</span>()</code><br>
    <code
      class='ncode'><span class = 'function'>&nbsp;&nbsp;&nbsp; print</span>(<span class = 'variable'>"R-squared value is"</span>, 1-(d1.<span class="function">dot</span>(d1)/d2.<span class="function">dot</span>(d2)))</code><br><br>

    <code class="ncode"><span class="keyword">def</span><span class="function"> sklearn_model</span>(self)</code><br>
    <code
      class="ncode">&nbsp;&nbsp;&nbsp; model <span class="keyword">= </span><span class="function">LinearRegression</span>()</code><br>
    <code
      class="ncode">&nbsp;&nbsp;&nbsp; model.<span class="function">fit</span>(self.<span class="module">X</span>, self.<span class="module">Y</span>)</code><br>
    <code
      class='ncode'><span class = 'function'>&nbsp;&nbsp;&nbsp; print</span>(<span class = 'variable'>"Sklearn model score is"</span>, model.<span class="function">score</span>(self.<span class="module">X</span>, self.<span class="module">Y</span>))</code><br>
    <code
      class='ncode'><span class = 'function'>&nbsp;&nbsp;&nbsp; print</span>(<span class = 'variable'>"Sklearn model weights"</span>, model.<span class="module">coef_</span></code>)<br>
    <code
      class='ncode'><span class = 'function'>&nbsp;&nbsp;&nbsp; print</span>(<span class = 'variable'>"Sklearn model intercept"</span>, model.<span class="module">intercept_</span>)</code>
  </div><br>

  <div class='codediv'>
    <code class='ncode'>Slope is 0.51 and Intercept is -0.01 <br>
      R-squared value is 0.9576039060788152 <br>
      Sklearn model score is 0.9576039802687464 <br>
      Sklearn model weights [[0.50907253]] <br>
      Sklearn model Intercept [-0.00820514] <br></code>
  </div><br>
  <p class='content'>Well, there it is! Just by using intermediate calculus knowledge, we now have an algorithm for 1-D
    Linear Regression. <span class='highlight'> Another fascinating point is that, most
      widely
      used sklearn module,
      Linear Regression seems to use
      the same exact code.</span> (For 1-D Linear Regression at least) Results are shown above. This is a great starting
    point to dive into Machine Learning. Make sure to take a look at the code.</p>
  <p class='content'>Note: Concepts including Gradient descent etc., have not
      been discussed in this article
      and are
      saved for future ones. Taking a simple approach towards Machine Learning is very effective instead of using
      existing
      modules. It's not a plug-and-play game after all.</p>
  <p class='content'>Thank you for reading this article.</p>
  <!-- <p class='scenter' style="font-size: 16px"><a href="https://www.linkedin.com/in/nareshkumar1040/"
      style="text-decoration:none;color:#52b788">NareshKumar Devulapally</a></p> -->



  <!-- <div class=" codediv">
    <code class="faded">this is a comment</code><br>
    <code class="ncode"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</code><br>
    <code class="ncode"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</code><br>
    <code
      class="ncode">squarify.<span class = "function">plot</span>(sizes=df[<span class = "variable">"Revenue"</span>], label=df[<span class="variable">"label"</span>], alpha=<span class = "number">0.8</span>, color<span class="keyword">=</span>colors)</code><br>
    <code
      class="ncode">norm <span class = "keyword">=</span> matplotlib.<span class = "module">colors</span>.<span class = "function">Normalize</span>(vmin<span class = "keyword">=</span>mini, vmax<span class = "keyword">=</span>maxi)</code><br>
    </div><br>
  <div class="codediv">
    <code class="faded">lets see this comment</code> -->

  <!-- </div><br> -->
  <!-- <p class="latex">\(\begin{align}\frac{\partial }{\partial \theta_{j}} J(\theta) &= \frac{\partial }{\partial
    \theta_{j}}\frac{1}{2}(h_{\theta}(x)-y)^2 \\
    &= 2\cdot\frac{1}{2}(h_{\theta}(x)-y)\cdot\frac{\partial }{\partial \theta_{j}} (h_{\theta}(x)-y)\end{align}\)</p>
  <p class="latex">\(\theta_{i} = J(\theta)\)</p><br>
  <p class="scenter"></p> -->
  <!-- <p class="scenter">In the above equation \(J(\theta)\) represents the loss function</p>
  <p class="latex">\(\begin{align}\frac{\partial }{\partial \theta_{j}} J(\theta) &= \frac{\partial }{\partial
    \theta_{j}}\frac{1}{2}(h_{\theta}(x)-y)^2 \\
    &= 2\cdot\frac{1}{2}(h_{\theta}(x)-y)\cdot\frac{\partial }{\partial \theta_{j}} (h_{\theta}(x)-y)\end{align}\)</p>
  <br>
  <table border="1" class="table">
    <thead>
      <tr>
        <th></th>
        <th>Movie</th>
        <th>Revenue</th>
        <th>Label</th>
        <th>Percentage</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>6</th>
        <td>Episode 7 - The Force Awakens</td>
        <td>4068223624</td>
        <td>The Force Awakens (37.68%)</td>
        <td>37.68</td>
      </tr>
      <tr>
        <th>7</th>
        <td>Rogue One</td>
        <td>2450000000</td>
        <td>Rogue One (22.69%)</td>
        <td>22.69</td>
      </tr>
      <tr>
        <th>0</th>
        <td>Episode 1 - The Phantom Menace</td>
        <td>924317558</td>
        <td>The Phantom Menace (8.56%)</td>
        <td>8.56</td>
      </tr>
      <tr>
        <th>2</th>
        <td>Episode 3 - Revenge of the Sith</td>
        <td>848754768</td>
        <td>Revenge of the Sith (7.86%)</td>
        <td>7.86</td>
      </tr>
      <tr>
        <th>3</th>
        <td>Episode 4 - A New Hope</td>
        <td>775398007</td>
        <td>A New Hope (7.18%)</td>
        <td>7.18</td>
      </tr>
      <tr>
        <th>1</th>
        <td>Episode 2 - Attack of the Clones</td>
        <td>649398328</td>
        <td>Attack of the Clones (6.01%)</td>
        <td>6.01</td>
      </tr>
      <tr>
        <th>4</th>
        <td>Episode 5 - Empire Strikes Back</td>
        <td>538375067</td>
        <td>Empire Strikes Back (4.99%)</td>
        <td>4.99</td>
      </tr>
      <tr>
        <th>5</th>
        <td>Episode 6 - Return of the Jedi</td>
        <td>475106177</td>
        <td>Return of the Jedi (4.4%)</td>
        <td>4.40</td>
      </tr>
      <tr>
        <th>8</th>
        <td>The Clone Wars</td>
        <td>68282844</td>
        <td>The Clone Wars (0.63%)</td>
        <td>0.63</td>
      </tr>
    </tbody>
  </table><br><br><br>
  <p></p>
  <p></p> -->
  <button id="copy_btn">
  </button>
  <p class="scenter" style="font-size: 16px"><a href="https://www.linkedin.com/in/nareshkumar1040/"
      style="text-decoration:none;color:#52b788">NareshKumar Devulapally</a></p>
       <script type="text/javascript">
    // check for saved 'darkMode' in localStorage
let darkMode = localStorage.getItem('darkMode'); 

const darkModeToggle = document.querySelector('#dark-mode-toggle');

const enableDarkMode = () => {
  // 1. Add the class to the body
  document.body.classList.add('darkmode');
  // 2. Update darkMode in localStorage
  localStorage.setItem('darkMode', 'enabled');
}

const disableDarkMode = () => {
  // 1. Remove the class from the body
  document.body.classList.remove('darkmode');
  // 2. Update darkMode in localStorage 
  localStorage.setItem('darkMode', null);
}
 
// If the user already visited and enabled darkMode
// start things off with it on
if (darkMode === 'enabled') {
  enableDarkMode();
}

// When someone clicks the button
darkModeToggle.addEventListener('click', () => {
  // get their darkMode setting
  darkMode = localStorage.getItem('darkMode'); 
  
  // if it not current enabled, enable it
  if (darkMode !== 'enabled') {
    enableDarkMode();
  // if it has been enabled, turn it off  
  } else {  
    disableDarkMode(); 
  }
});


    
  </script>
</body>

</html>