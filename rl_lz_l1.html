<!DOCTYPE html>
<html>

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QLEH0W42YV"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-QLEH0W42YV');
  </script>
  <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous"> -->

  <link id="mystylesheet" rel="stylesheet" type="text/css" href="light.css">
  <!-- <link rel="stylesheet" href="light.css"> -->
  <link rel="icon" href="brain1.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Alegreya+Sans+SC:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Nunito&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  <!-- <script>
    function myFunction() {
      var element = document.body;
      element.classList.toggle("dark-mode");
    }
  </script> -->
  <title>EssentialAI</title>
</head>

<body>
  <div class="topnav">
   <a class="top" href="index.html">Blog</a>
    <a class="top" href="about.html">About</a>
    <!-- <a class="top" href="publications.html">Publications</a> -->
    <!-- <a id="small" href="research.html">Misc. research articles</a> -->
    <button id="dark-mode-toggle" class="dark-mode-toggle">
  <svg width="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 496"><path fill="currentColor" d="M8,256C8,393,119,504,256,504S504,393,504,256,393,8,256,8,8,119,8,256ZM256,440V72a184,184,0,0,1,0,368Z" transform="translate(-8 -8)"/></svg>
</button>
  </div>
  <!-- Start your blog here -->
  <!-- ################################################################################ -->

  <h1 class="bloghead">Multi-arm bandit Problem & Solutions</h1><br>
  <p class = 'content'>Let's say you walk into a casino with a bag full of money. You exchanged this money for casino coins and would like to try your luck with the slot machines. You notice that there are 4 slot machines. Each machine has a constant reward (of $1 or $0) but the probability of receiving a reward for every machine is different. Now your aim is to get the maximum reward from these slot machines without incurring any loss on the way.</p>
  <div class="center"><img src="slot_machines.jpg" style="border-radius: 5px;"></div>
<p class = 'content'>You might think that you would play one slot machine each time and pick the ones that yielded a reward. However, this method has many flaws. What if the machine with the highest win-rate has not yet yielded the reward and you missed out on that machine just because it didn't give a reward in the first pull. In that case can we put 12 coins aside (3 for each) and look at the average rewards for each machine and then play the one with the maximum average-reward. In such case a question arises "What is the minimum number of coins to be put aside before coming to a conclusion for the best machine?" A statistician would say infinite because of the <a href="https://en.wikipedia.org/wiki/Law_of_large_numbers" target="_blank" style="text-decoration: none; color :#52b788">Law of large numbers</a>. This results in a dilemma. We are confused whether to wait until a significant estimation of win-rates for every machine is obtained (which indirectly leads to wasting many coins for low reward) or to keep playing a single machine that yielded the best reward in intial short time. This dilemma is called <span class = 'highlight'>Exploration v/s Exploitation Dilemma.</span></p>
<p class = 'content'>To overcome this dilemma, we explore the slot machines for some coins at random steps and use that information to pull the slot that yields the best reward until that point in time, known as exploitation. This dilemma is present in all multi-armed bandit problems which have several real-life use cases such as, choosing a better ad that attracts most user clicks, recommending the best movie as per user's preference, A/B Testing and so on.</p>

<p class='content'>
    <span class='highlight' style="font-size: 22px; font-family: 'Alegreya Sans SC', sans-serif;">Problem Formulation</span>
  </p>
<div class = 'content'><ul><li>We have \(K\) machine with reward probabilities, \({\theta_1, \theta_2,...,\theta_k}\).</li>
<li>At each time step t, we pull the slot machine's arm and receive a reward \(r\).</li>
<li>\(A\) is a set of actions, each referring to pulling a machine's arm. The value of expected reward is given by, <span class = 'latex'>\(Q(a) = E[r|a] = \theta\)</span>. If action \(a_t\) at the time step t is on the \(i_{th}\) machine, <span class = 'latex'>\(Q(a_t) = \theta_i\)</span>.</li>
<li>\(R\) is a reward function. At the time step t, <span class = 'latex'>\(r_t = R(a_t)\)</span> may return reward 1 with a probability <span class = 'latex'>\(Q(a_t)\)</span> or 0 otherwise.</li>
<li>Our goal is to maximize the cumulatice reward <span class = 'latex'>\(\begin{align} \sum_{t=1}^{T}r_t\end{align}\)</span></li>
</ul>
</div>
<p class = 'content'>The optimal reward probability \(\theta^*\) of the optimal action \(a^*\) is:</p>
<p class = 'scenter'><span class = 'latex'>\(\begin{align}\theta^{*}=Q(a^{*})=\max_{a \in \mathcal{A}} Q(a) = \max_{1 \leq i \leq K} \theta_i \end{align}\)</span></p>
<p class='content'>
    <span class='highlight' style="font-size: 22px; font-family: 'Alegreya Sans SC', sans-serif;">Epsilon-Greedy algorithm</span>
  </p>
<p class = 'content'>The idea here is that, we take the best action (the slot machine with maximum calculated estimate), while setting an epsilon (%) that explore machines at random based on \(\epsilon\) value.</p>
<div class = 'codediv'>
  <code class='function'>#Greedy Algorithm</code><br>
  <code class='ncode'>while True:</code><br>
  <code class= 'ncode'>&nbsp;&nbsp;&nbsp; j = argmax(predicted bandit means)</code><br>
  <code class= 'ncode'>&nbsp;&nbsp;&nbsp; x = play bandit j and get reward</code><br>
  <code class= 'ncode'>&nbsp;&nbsp;&nbsp; bandits[j].update_mean(x)</code><br><br>

  <code class='function'>#Epsilon-Greedy Algorithm</code><br>
  <code class='ncode'>while True:</code><br>
  <code class= 'ncode'>&nbsp;&nbsp;&nbsp; p = random number in [0,1]</code><br>
  <code class= 'ncode'>&nbsp;&nbsp;&nbsp; if p < epsilon:</code><br>
  <code class= 'ncode'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j = choose a random bandit</code><br>
  <code class= 'ncode'>&nbsp;&nbsp;&nbsp; else:</code><br>
  <code class= 'ncode'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j = argmax(predicted bandit means)</code><br>
  <code class= 'ncode'>&nbsp;&nbsp;&nbsp; x = play bandit j and get reward</code><br>
  <code class= 'ncode'>&nbsp;&nbsp;&nbsp; bandits[j].update_mean(x)</code><br>
</div>
<hr class="line">
  <button id="copy_btn">
  </button>
  <p class="scenter" style="font-size: 16px"><a href="https://www.linkedin.com/in/nareshkumar1040/"
      style="text-decoration:none;color:#52b788">NareshKumar Devulapally</a></p>
        <script type="text/javascript">
    // check for saved 'darkMode' in localStorage
let darkMode = localStorage.getItem('darkMode'); 

const darkModeToggle = document.querySelector('#dark-mode-toggle');

const enableDarkMode = () => {
  // 1. Add the class to the body
  document.body.classList.add('darkmode');
  // 2. Update darkMode in localStorage
  localStorage.setItem('darkMode', 'enabled');
}

const disableDarkMode = () => {
  // 1. Remove the class from the body
  document.body.classList.remove('darkmode');
  // 2. Update darkMode in localStorage 
  localStorage.setItem('darkMode', null);
}
 
// If the user already visited and enabled darkMode
// start things off with it on
if (darkMode === 'enabled') {
  enableDarkMode();
}

// When someone clicks the button
darkModeToggle.addEventListener('click', () => {
  // get their darkMode setting
  darkMode = localStorage.getItem('darkMode'); 
  
  // if it not current enabled, enable it
  if (darkMode !== 'enabled') {
    enableDarkMode();
  // if it has been enabled, turn it off  
  } else {  
    disableDarkMode(); 
  }
});


    
  </script>
</body>

</html>